## åå°ç®¡ç†ç³»ç»Ÿ

### é¡¹ç›®æè¿°

* æ­¤é¡¹ç›®ä¸ºä¸€ä¸ªå‰åå°åˆ†ç¦»çš„åå°ç®¡ç†çš„SPA, åŒ…æ‹¬å‰ç«¯PCåº”ç”¨å’Œåç«¯åº”ç”¨
* åŒ…æ‹¬ç”¨æˆ·ç®¡ç† / å•†å“åˆ†ç±»ç®¡ç† / å•†å“ç®¡ç† / æƒé™ç®¡ç†ç­‰åŠŸèƒ½æ¨¡å—
* å‰ç«¯: ä½¿ç”¨Reactå…¨å®¶æ¡¶ + Antd + Axios + ES6+ + Webpackç­‰æŠ€æœ¯
* åç«¯: ä½¿ç”¨Node + Express + Mongodbç­‰æŠ€æœ¯
*  é‡‡ç”¨æ¨¡å—åŒ–ã€ç»„ä»¶åŒ–ã€å·¥ç¨‹åŒ–çš„æ¨¡å¼å¼€å‘



### æŠ€æœ¯é€‰å‹

##### å‰å°æ•°æ®å±•ç°/äº¤äº’/ç»„ä»¶åŒ–

* react
* react-router-dom
* antd
* redux



##### åå°åº”ç”¨

* node
* mongodb
* mongoose
* multer
* blueimp-md5



##### å‰åå°äº¤äº’

* ajaxè¯·æ±‚
  * axios
  * jsonp
  * promise/async/await
* æ¥å£æµ‹è¯•å·¥å…·
  * postman

æ¨¡å—åŒ–

* ES6
* CommonJS



é¡¹ç›®æ„å»ºå·¥å…·/å·¥ç¨‹åŒ–

* webpack
* create-react-app
* eslint

å…¶ä»–

* å¯Œæ–‡æœ¬ç¼–è¾‘å™¨
  * react-draft-wysiwyg
  * draft-js
  * draftjs-to-html
* å›¾è¡¨åº“
  * echarts
  * echarts-for-react



### API/æ¥å£

ä¸€ä¸ªå‰åç«¯åˆ†ç¦»é¡¹ç›®çš„APIæ¥å£åŒ…æ‹¬å››ä¸ªéƒ¨åˆ†

* è¯·æ±‚URL
* è¯·æ±‚æ–¹å¼
* å‚æ•°ç±»å‹
* è¿”å›å€¼



##### é‡è¦æ¦‚å¿µ

* API(æ¥å£)
* æ¥å£æ–‡æ¡£
  * APIæ¥å£çš„æ–‡æ¡£

* æµ‹è¯•æ¥å£
  * å‰ç«¯å¯¹ç…§æ¥å£æ–‡æ¡£ï¼Œæµ‹è¯•æ¥å£åŠŸèƒ½
* å¯¹æ¥å£
  * å‰åç«¯å¯¹æŸä¸ªåŠŸèƒ½çš„APIå¯¹æ¥
* è°ƒæ¥å£
  * ä½¿ç”¨æ¥å£
* è”è°ƒ
  * å‰åå°å†™å¥½çš„ä»£ç ä¸€èµ·ä½¿ç”¨
* å‰åå°åˆ†ç¦»
  * é¢å‘APIæ–‡æ¡£å¼€å‘

* mockï¼ˆæ¨¡æ‹Ÿï¼‰æ•°æ®



### æ­å»ºç¯å¢ƒ

1. å®‰è£…create-react-app

   `npm install -g create-react-app` å…¨å±€ä¸‹è½½å·¥å…·

2. åˆ›å»ºé¡¹ç›® 

   `npx create-react-app myApp`

3. æµ‹è¯•

   å¼€å‘ç¯å¢ƒæµ‹è¯•

   `npm start` æˆ–è€… `yarn start`

   è®¿é—®ä¸€ä¸‹é¡µé¢

   

   ç”Ÿäº§ç¯å¢ƒæµ‹è¯•

   æ‰“åŒ…`npm run build`

   å®‰è£…ç”Ÿäº§æœåŠ¡å™¨è½¯ä»¶ ` npm install -g serve`

   å¯åŠ¨æœåŠ¡å™¨ `server build`

   æˆ–è€…

   æ‰“åŒ…`yarn build`

   å®‰è£…ç”Ÿäº§æœåŠ¡å™¨è½¯ä»¶ `yarn global add serve`

   å¯åŠ¨æœåŠ¡å™¨

   `serve -s build`

   

   ä¸‰ä¸ªå…¥å£

   > é¡µé¢å…¥å£ index.html

   æ ¹æ ‡ç­¾  `<div id="root"></div>`

   

   > jså…¥å£ index.js

   ```javascript
   import React from 'react'
   import ReactDOM from 'react-dom'
   
   import App from './App'
   
   ReactDOM.render(<App />, document.getElementById('root'))
   ```

   

   > ç»„ä»¶å…¥å£ App.jsx

   ```javascript
   import React, {Component} from 'react'
   /*
   åº”ç”¨æ ¹ç»„ä»¶
    */
   class App extends Component {
     render() {
       return (
         <div>App</div>
       )
     }
   }
   
   export default App
   ```



#### ä½¿ç”¨antdç»„ä»¶åº“

[antdæ–‡æ¡£](https://ant.design/docs/react/introduce-cn)

`yarn add antd`

#### å¦‚ä½•æŒ‰éœ€åŠ è½½éœ€è¦çš„cssæ ·å¼

##### 1. ä¸‹è½½ä¾èµ–æ¨¡å—
```shell
	npm install --save-dev react-app-rewired customize-cra babel-plugin-import
	npm install --save-dev less less-loader
	
	æˆ–è€…
	yarn add react-app-rewired customize-cra babel-plugin-import
	yarn add less less-loader
```

##### 2. æ·»åŠ é…ç½®:  config-overrides.js
```javascript
const { override, fixBabelImports, addLessLoader } = require('customize-cra');

module.exports = override(
  // é…ç½®babel-plugin-import: 
  fixBabelImports('import', {
    libraryName: 'antd', // é’ˆå¯¹antdè¿›è¡ŒæŒ‰éœ€æ‰“åŒ…
    libraryDirectory: 'es', // å»esæ–‡ä»¶å¤¹å¯¹åº”çš„ç»„ä»¶è¿›è¡Œæ‰“åŒ…
    // style: 'css',  // è‡ªåŠ¨æ‰“åŒ…ç»„ä»¶å¯¹åº”çš„cssæ ·å¼
    style: true,  // åŠ è½½lessè¿›è¡Œé‡æ–°ç¼–è¯‘æ‰“åŒ…
  }),

  // æ·»åŠ lessçš„é…ç½®
  addLessLoader({
    javascriptEnabled: true,
    modifyVars: { '@primary-color': '#1DA57A' }, // æŒ‡å®šä¸»ä½“é¢œè‰²ä¸ºç»¿è‰²
  }),
);
```
##### 3. ä¿®æ”¹é…ç½®: package.json
```json
	"scripts": {
		"start": "react-app-rewired start",
		"build": "react-app-rewired build",
		"test": "react-app-rewired test",
		"eject": "react-scripts eject"
	}
```
##### 4. å»é™¤æ ·å¼å¼•å…¥
```javascript
// import 'antd/dist/antd.css'; 
```



#### å®‰è£…è·¯ç”±æ’ä»¶

react-router-dom[ä¸­æ–‡æ–‡æ¡£](https://react-router.docschina.org/)

å®‰è£…

`npm install react-router-dom`

æˆ–è€…

`yarn add react-router-dom`

é…ç½®è·¯ç”±



### ç™»å½•é¡µè®¾è®¡

#### è¡¨å•ç»„ä»¶

```javascript
//è¿™ä¸ªå‡½æ•°ä¼šå°†åˆçº§è¡¨å•ç»„ä»¶åŒ…è£…ï¼Œé€šè¿‡æ„é€ ä¼ å…¥ä¸€ä¸ªformå¯¹è±¡ï¼Œå¢å¼ºå…¶åŠŸèƒ½
const WrappedLogin = Form.create()(Login)

export default WrappedLogin
```

#### é«˜é˜¶ç»„ä»¶

```
å¦‚æœä¸€ä¸ªå‡½æ•°æ“ä½œå…¶ä»–å‡½æ•°ï¼Œå³å°†å…¶ä»–å‡½æ•°ä½œä¸ºå‚æ•°æˆ–å°†å‡½æ•°ä½œä¸ºè¿”å›å€¼ï¼Œå°†å…¶ç§°ä¸ºé«˜é˜¶å‡½æ•°ã€‚é«˜é˜¶ç»„ä»¶(high-order component)ç±»ä¼¼äºé«˜é˜¶å‡½æ•°ï¼Œæ¥æ”¶ React ç»„ä»¶ä½œä¸ºè¾“å…¥ï¼Œè¾“å‡ºä¸€ä¸ªæ–°çš„ React ç»„ä»¶ã€‚é«˜é˜¶ç»„ä»¶è®©ä»£ç æ›´å…·æœ‰å¤ç”¨æ€§ã€é€»è¾‘æ€§ä¸æŠ½è±¡ç‰¹å¾ã€‚å¯ä»¥å¯¹ render æ–¹æ³•ä½œåŠ«æŒï¼Œä¹Ÿå¯ä»¥æ§åˆ¶ props ä¸ stateã€‚
```

ç®€å•ä½¿ç”¨é«˜é˜¶ç»„ä»¶

```javascript
class Login extends Component {
    ...
}

export default Form.create()(Login)
```



> é…ç½®å¯¹è±¡ï¼šå±æ€§åå›ºå®šçš„å¯¹è±¡



#### è¾“å…¥æ¡†éªŒè¯

#### æ­é¡µé¢

* åˆ†æˆä¸‰éƒ¨åˆ†
  * ä¾§è¾¹æ 
  * header
  * content



##### å¸ƒå±€

* <layout>

##### å®šä¹‰ç»„ä»¶ï¼Œcomponentæ–‡ä»¶å¤¹

å·¦ä¾§å¯¼èˆª leftNav

å¤´éƒ¨ header

æ•´ç†é¡µé¢çš„å¤§ä½“æ¡†æ¶

##### å®šä¹‰è·¯ç”±ç»„ä»¶ï¼Œpageæ–‡ä»¶å¤¹

##### å¦‚ä½•æ³¨å†Œè·¯ç”±

ä¸€çº§è·¯ç”±æ³¨å†Œåˆ°ä¸»é¡µ

äºŒçº§è·¯ç”±æ³¨å†Œåˆ°ä¸€çº§è·¯ç”±çš„ç»„ä»¶ä¸­

ä¸‰çº§è·¯ç”±æ³¨å†Œåˆ°äºŒçº§è·¯ç”±çš„ç»„ä»¶ä¸­     

ä¸»é¡µhome,æ³¨å†Œåˆ°adminä¸­

```jsx
<Switch>
	<Route path="/home" component={Home}></Route>
    <Redirect to="/home"></Redirect>
</Switch>
```

##### ç¼–å†™å·¦ä¾§å¯¼èˆª

æ‹†åˆ†å¸ƒå±€

ä¸Šä¸‹è§£æ„ï¼šä¸Šlogoï¼Œä¸‹åˆ—è¡¨

å¼•å…¥è·¯ç”±

##### æ·»åŠ å¯¼èˆªèœå•

* \<menu>

```jsx
<menu>
  <Menu.Item>èœå•é¡¹</Menu.Item>
  <SubMenu title="å­èœå•">
    <Menu.Item>å­èœå•é¡¹</Menu.Item>
  </SubMenu>
</menu>
```

defaultSelectedKeys:åˆå§‹é€‰ä¸­çš„èœå•é¡¹ key æ•°ç»„

defaultOpenKeys:åˆå§‹å±•å¼€çš„ SubMenu èœå•é¡¹ key æ•°ç»„

â€‹	

key:å…ƒç´ çš„å”¯ä¸€æ ‡è¯†(ä¸è¦ç”¨Index)

Linkæ ‡ç­¾çš„ä½œç”¨

ä½¿ç”¨æ•°æ®é©±åŠ¨æ¸²æŸ“å·¦ä¾§å¯¼èˆª

```javascript
[
	{
      title: 'é¦–é¡µ', // èœå•æ ‡é¢˜åç§°
      key: '/home', // å¯¹åº”çš„path
      icon: 'home', // å›¾æ ‡åç§°
    },
    {
      title: 'å•†å“',
      key: '/products',
      icon: 'appstore',
      children: [ // å­èœå•åˆ—è¡¨
        {
          title: 'å“ç±»ç®¡ç†',
          key: '/category',
          icon: 'bars'
        },
        {
          title: 'å•†å“ç®¡ç†',
          key: '/product',
          icon: 'tool'
        },
      ]
    ]
```

å°†æ•°æ®ç»„è£…æˆä¸€ä¸ªæ ‡ç­¾æ•°ç»„,æ”¾åˆ°Menué‡Œ

```jsx
    /**
     *  <Menu.Item key="/product">
              <Link to="/product">
                <Icon type="github" />
                <span>å•†å“ç®¡ç†</span>
              </Link>
          </Menu.Item>
     */
    //è·å–ä¸€ä¸ªæ ‡ç­¾æ•°ç»„
    getMenuNodes = (menulist)=>{
        //mapè¿”å›ä¸€ä¸ªæ•°ç»„
        return menulist.map((item)=>{
            //å¦‚æœæ˜¯æ™®é€šçš„Item
            if(!item.children){
                //ç›´æ¥è¿”å›ç®€å•çš„æ ‡ç­¾
                return (
                    <Menu.Item key={item.key}>
                        <Link to={item.key}>
                        <Icon type={item.icon} />
                        <span>{item.title}</span>
                        </Link>
                    </Menu.Item>
                )
            }else{
                //å¦‚æœæ˜¯å¸¦æœ‰å­é¡¹çš„SubMenuå°±é€’å½’è°ƒç”¨æ­¤å‡½æ•°ï¼Œå°†è¿”å›çš„æ•°ç»„æ’å…¥ç»“æœ
                return (
                    <SubMenu
                    key={item.key}
                    title={
                        <span>
                        <Icon type={item.icon} />
                        <span>{item.title}</span>
                        </span>
                    }
                    >
                        {/* {}å°†è¿”å›çš„æ•°ç»„æ’åˆ°æ ‡ç­¾ä¸­ */}
                        {this.getMenuNodes(item.children)}


                    </SubMenu>
                )
            }
        })
    }
```

##### å¦‚ä½•è®¾ç½®é»˜è®¤é€‰ä¸­çš„èœå•é¡¹

è¦æ±‚

1. åˆ·æ–°ç‚¹å‡»æ—¶,é€‰ä¸­ç›¸åº”çš„èœå•é¡¹

   ä½¿ç”¨withRouteråŒ…è£…left-nav,è·å–location

   é€šè¿‡locationè·å–åˆ°key(é¡¹ç›®ä¸­ä¸ºè·¯ç”±è·¯å¾„)

   ä½¿ç”¨selectedKeysæŒ‡å®šè¦é€‰ä¸­çš„èœå•é¡¹

2. å¦‚æœé€‰ä¸­çš„æ˜¯äºŒçº§èœå•,å±•å¼€å¯¹åº”çš„SubMenuçš„äºŒçº§èœå•åˆ—è¡¨ 

   åœ¨ç”Ÿæˆèœå•é¡¹æ•°ç»„æ—¶æ£€æŸ¥å“ªä¸ªSubMenuçš„childè¢«å‘½ä¸­,è®¾ç½®æ¬¡SubMenuçš„keyä½œä¸ºdefaultOpenKeys,å°±ä¼šè¾¾åˆ°è‡ªåŠ¨å±•å¼€çš„æ•ˆæœ

:warning:æ³¨æ„

```
defaultSelectedKeysçš„ç‰¹ç‚¹,ç¬¬ä¸€æ¬¡æŒ‡å®šæœ‰æ•ˆ,å¤šæ¬¡æŒ‡å®šæ— æ•ˆ

SelectedKeys æ¯æ¬¡æŒ‡å®šéƒ½ç”Ÿæ•ˆ 
```



ç»„ä»¶ä¸­çš„é…ç½®é¡¹

é…ç½®é¡¹å†™æˆç»„ä»¶æ ‡ç­¾çš„å±æ€§

```jsx
 <Menu
        onClick={this.handleClick}
        style={{ width: 256 }}
        defaultSelectedKeys={['1']}
        defaultOpenKeys={['sub1']}
        mode="inline"
      >
```



|                     |                                    |          |
| ------------------- | ---------------------------------- | -------- |
| defaultOpenKeys     | åˆå§‹å±•å¼€çš„ SubMenu èœå•é¡¹ key æ•°ç»„ | string[] |
| defaultSelectedKeys | åˆå§‹é€‰ä¸­çš„èœå•é¡¹ key æ•°ç»„          | string[] |



è¯»å–å½“å‰è¯·æ±‚çš„è·¯ç”±è·¯å¾„è®¾ç½®åˆ°ä¸Šæ–¹çš„å±æ€§ä¸Š

å¦‚ä½•è¯»å–å‘¢

```
this.props.location.pathname
```

React-Router è·¯ç”±çš„ä¸‰å¤§å±æ€§

##### `history` å¯¹è±¡é€šå¸¸ä¼šå…·æœ‰ä»¥ä¸‹å±æ€§å’Œæ–¹æ³•ï¼š

â­é‡è¦çš„å±æ€§

- push(path, [state])` - (function ç±»å‹) åœ¨ history å †æ ˆæ·»åŠ ä¸€ä¸ªæ–°æ¡ç›®
- `replace(path, [state])` - (function ç±»å‹) æ›¿æ¢åœ¨ history å †æ ˆä¸­çš„å½“å‰æ¡ç›®
- `go(n)` - (function ç±»å‹) å°† history å †æ ˆä¸­çš„æŒ‡é’ˆè°ƒæ•´ `n`
- `goBack()` - (function ç±»å‹) ç­‰åŒäº `go(-1)`
- `goForward()` - (function ç±»å‹) ç­‰åŒäº `go(1)`
- `block(prompt)` - (function ç±»å‹) é˜»æ­¢è·³è½¬ã€‚(è¯¦è§ [history æ–‡æ¡£](https://github.com/ReactTraining/history#blocking-transitions))ã€‚

ğŸ’©ä¸é‡è¦çš„å±æ€§

- `length` - (number ç±»å‹) history å †æ ˆçš„æ¡ç›®æ•°

- `action` - (string ç±»å‹) å½“å‰çš„æ“ä½œ(`PUSH`, `REPLACE`, `POP`)

- location

  \- (object ç±»å‹) å½“å‰çš„ä½ç½®ã€‚location ä¼šå…·æœ‰ä»¥ä¸‹å±æ€§ï¼š

  - `pathname` - (string ç±»å‹) URL è·¯å¾„
  - `search` - (string ç±»å‹) URL ä¸­çš„æŸ¥è¯¢å­—ç¬¦ä¸²
  - `hash` - (string ç±»å‹) URL çš„å“ˆå¸Œç‰‡æ®µ
  - `state` - (object ç±»å‹) æä¾›ç»™ä¾‹å¦‚ä½¿ç”¨ `push(path, state)` æ“ä½œå°† location æ”¾å…¥å †æ ˆæ—¶çš„ç‰¹å®š location çŠ¶æ€ã€‚åªåœ¨æµè§ˆå™¨å’Œå†…å­˜å†å²ä¸­å¯ç”¨ã€‚

  

##### location

location å¯¹è±¡æ°¸è¿œä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå› æ­¤ä½ å¯ä»¥åœ¨ç”Ÿå‘½å‘¨æœŸé’©å­ä¸­ä½¿ç”¨å®ƒæ¥ç¡®å®šä½•æ—¶å¯¼èˆªï¼Œè¿™å¯¹æ•°æ®æŠ“å–å’ŒåŠ¨ç”»éå¸¸æœ‰ç”¨ã€‚

```javascript
pathname,search(ä¿å­˜çš„æ˜¯queryString),hashæ¯”è¾ƒé‡è¦

{
  key: 'ac3df4', // not with HashHistory!
  pathname: '/somewhere'
  search: '?some=search-string',
  hash: '#howdy',
  state: {
    [userDefined]: true
  }
}
```

##### match

ä¸€ä¸ª `match` å¯¹è±¡ä¸­åŒ…æ¶µäº†æœ‰å…³å¦‚ä½•åŒ¹é… URL çš„ä¿¡æ¯ã€‚`match` å¯¹è±¡ä¸­åŒ…æ¶µä»¥ä¸‹å±æ€§ï¼š

- `params` - (object) keyï¼value ä¸åŠ¨æ€è·¯å¾„çš„ URL å¯¹åº”è§£æ
- `isExact` - (boolean) `true` å¦‚æœåŒ¹é…æ•´ä¸ª URL ï¼ˆæ²¡æœ‰ç»“å°¾å­—ç¬¦ï¼‰
- `path` - (string) ç”¨äºåŒ¹é…çš„è·¯å¾„æ¨¡å¼ã€‚è¢«åµŒå¥—åœ¨ `<Route>` ä¸­ä½¿ç”¨
- `url` - (string) ç”¨äºåŒ¹é…éƒ¨åˆ†çš„ URL ã€‚è¢«åµŒå¥—åœ¨ `<Link>` ä¸­ä½¿ç”¨



##### ä¸ºä»€ä¹ˆä½¿ç”¨withRouter

When you include a main page component in your app, it is often wrapped in a `<Route>` component like this:

åœ¨ä½ çš„appä¸­åŒ…å«çš„ä¸»è¦ä¸»è¦é¡µé¢ç»„ä»¶,ä¼šç»å¸¸è¢«<Router>ç»„ä»¶åŒ…è£…,æƒ³ä¸‹é¢è¿™æ ·

```js
<Route path="/movies" component={MoviesIndex} />
```



By doing this, the `MoviesIndex` component has access to `this.props.history` so it can redirect the user with `this.props.history.push`.

é€šè¿‡è¿™ä¹ˆåš,<MoviesIndex>ç»„ä»¶å¯ä»¥è®¿é—®`this.props.history`(è·¯ç”±ä¸‰å¤§å±æ€§ä¹‹ä¸€),å› æ­¤ä½ èƒ½ç”¨

`this.props.history.push`å°†ç”¨æˆ·redirect(é‡å®šå‘) 



Some components (commonly a header component) appear on every page, so are not wrapped in a `<Route>`:

ä¸€äº›ç»„ä»¶(é€šå¸¸æ˜¯header ç»„ä»¶)å‡ºç°åœ¨æ¯ä¸ªé¡µé¢,æ‰€ä»¥ä¸ç”¨<Router>åŒ…è£…

```js
render() {
  return (<Header />);
}
```

This means the header cannot redirect the user.

è¿™(æ²¡æœ‰è¢«RouteråŒ…è£…)æ„å‘³ç€headerä¸èƒ½å°†ç”¨æˆ·redirct



To get around this problem, the header component can be wrapped in a [`withRouter`](https://github.com/ReactTraining/react-router/blob/master/packages/react-router/docs/api/withRouter.md) function, either when it is exported:

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜,å¤´éƒ¨ç»„ä»¶å¯ä»¥ç”¨ [`withRouter`](https://github.com/ReactTraining/react-router/blob/master/packages/react-router/docs/api/withRouter.md) å‡½æ•°åŒ…è£…,æˆ–è€…åœ¨export(æš´éœ²)çš„æ—¶å€™åŒ…è£…

```js
export default withRouter(Header)
```

This gives the `Header` component access to `this.props.history`, which means the header can now redirect the user.

è¿™ä½¿å¾—Headerç»„ä»¶å¯ä»¥è®¿é—®åˆ°`this.props.history`,æ‰€ä»¥ä¹Ÿä»£è¡¨è¿™ä¸ªHeaderç»„ä»¶å¯å°†ç”¨æˆ·é‡å®šå‘äº†





##### å¤´éƒ¨ç»„ä»¶çš„ç¼–å†™

å¸ƒå±€

##### ç®­å¤´(ä½¿ç”¨ä¼ªå…ƒç´ )

```css
 .header-bottom-left {
     		/*å®šä½*/
            position: relative;
            width: 25%;
            text-align: center;
            &::after{
                content: '';
                /*å®šä½*/
                position: absolute;
                /*æ°´å¹³å±…ä¸­*/
                left: 50%;
                transform: translateX(-50%);
                top:30px;
                border-top: 20px solid rebeccapurple;
                border-left: 20px solid transparent;
                border-right: 20px solid transparent;
                border-bottom: 20px solid transparent;

            }
        }
```



åŠ¨æ€æ˜¾ç¤ºæ•°æ®

* ç”¨æˆ·å ä»å†…å­˜ä¸­è¯»
* è·å–Title,ä»menuConfigä¸­è·å–,æŒ‰ç…§å½“å‰çš„è·¯ç”±

```javascript
   //æ ¹æ®å½“å‰è¯·æ±‚çš„è·¯å¾„ï¼Œè®¾ç½®Title
    getTitle = (menus)=>{
        const pathname = this.props.location.pathname
        // console.log('P:'+pathname)
        let title = '';

        // menus.forEach(item=>{
            
        //     if(!item.children){
        //         if(item.key === pathname){
        //             title =  item.title
        //         }
        //     }else{
        //         if(this.getTitle(item.children)){
        //             title =  this.getTitle(item.children)
        //         }
        //     }
        // })
	
        //è¿™ä¸ªæ•ˆç‡ç¨å¾®é«˜ä¸€ç‚¹
        menus.some(item=>{
            
            if(!item.children){
                if(item.key === pathname){
                    title =  item.title
                    return true
                }else{
                    return false
                }
            }else{
                if(this.getTitle(item.children)){
                    title =  this.getTitle(item.children)
                    return true
                }
            }
        })
        return title;
    }
```

* æ˜¾ç¤ºäº‹ä»¶

ä½¿ç”¨å®šæ—¶å™¨ä¸€ç›´æ”¹å˜çŠ¶æ€



* æ˜¾ç¤ºå¤©æ°”

http://api.map.baidu.com/telematics/v3/weather?location=shanghai&output=json&ak=3p49MVra6urFRGOT9s8UBWr2

```json
{
  "error": 0,
  "status": "success",
  "date": "2019-09-03",
  "results": [
    {
      "currentCity": "shanghai",
      "pm25": "41",
      "index": [],
      "weather_data": [
        {
          "date": "å‘¨äºŒ 09æœˆ03æ—¥ (å®æ—¶ï¼š24â„ƒ)",
          "dayPictureUrl": "http://api.map.baidu.com/images/weather/day/zhongyu.png",
          "nightPictureUrl": "http://api.map.baidu.com/images/weather/night/xiaoyu.png",
          "weather": "ä¸­é›¨è½¬å°é›¨",
          "wind": "åŒ—é£å¾®é£",
          "temperature": "26 ~ 23â„ƒ"
        },
        {
          "date": "å‘¨ä¸‰",
          "dayPictureUrl": "http://api.map.baidu.com/images/weather/day/zhongyu.png",
          "nightPictureUrl": "http://api.map.baidu.com/images/weather/night/xiaoyu.png",
          "weather": "ä¸­é›¨è½¬å°é›¨",
          "wind": "ä¸œé£3-4çº§",
          "temperature": "28 ~ 23â„ƒ"
        },
        {
          "date": "å‘¨å››",
          "dayPictureUrl": "http://api.map.baidu.com/images/weather/day/xiaoyu.png",
          "nightPictureUrl": "http://api.map.baidu.com/images/weather/night/xiaoyu.png",
          "weather": "å°é›¨",
          "wind": "ä¸œé£3-4çº§",
          "temperature": "27 ~ 24â„ƒ"
        },
        {
          "date": "å‘¨äº”",
          "dayPictureUrl": "http://api.map.baidu.com/images/weather/day/xiaoyu.png",
          "nightPictureUrl": "http://api.map.baidu.com/images/weather/night/duoyun.png",
          "weather": "å°é›¨è½¬å¤šäº‘",
          "wind": "è¥¿åŒ—é£4-5çº§",
          "temperature": "28 ~ 24â„ƒ"
        }
      ]
    }
  ]
}

```

```
å–å¾—æ•°æ®
data.results[0].weather_data[0].weather
data.results[0].weather_data[0].dayPictureUrl
```

ç¼–å†™æ¥å£

```javascript
1.å¼•å…¥jsonp
2.ä½¿ç”¨promiseæ¥æ”¶jsonpå‘é€çš„å¼‚æ­¥è¯·æ±‚

//ä»¥ä¸‹ä¸ºä¼ªä»£ç 

import jsonp from 'jsonp'

//å®šä¹‰ä¸€ä¸ªè¿”å›promiseçš„æ–¹æ³•
getWeather = ()=>{
	return new Promise((resolve,reject)=>{
		//å‘é€jsonp,æ³¨æ„ä¸‰ä¸ªå‚æ•°
		jsonp('http://www.bilibili.com',{},(err,data)=>{
			//è¯·æ±‚æˆåŠŸä¿å­˜æ•°æ®
			if(!err){
				resolve(data)
			}else{//è¯·æ±‚å¤±è´¥
				//ä¼ é€’é”™è¯¯ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥éšä¾¿ä¼ ç‚¹å­—ç¬¦ä¸²
				reject(err)
			}
		})
	})
}

//åœ¨ç»„ä»¶ä¸­çš„é’©å­å‡½æ•°ä¸­è°ƒç”¨æ­¤æ–¹æ³•
async componendDidMount(){
	const data = await getWeather()
	//ä¿å­˜åˆ°æŸä¸ªåœ°æ–¹
	æ³¨æ„ï¼Œasyncçš„æ•´ä¸ªå‡½æ•°ä¼šè¢«æ”¾åˆ°å¾®é˜Ÿåˆ—é‡Œé¢å»ï¼Œå› æ­¤ç¬¬ä¸€æ¬¡render()æ˜¯æ²¡æœ‰å€¼çš„ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡data.xxxå–å€¼ï¼Œä¼šæŠ¥can't read property 'xxx' of undifiend
	//æ‰€ä»¥æœ€å¥½å°†æ•°æ®ç›´æ¥ä¿å­˜ï¼Œæ¯”å¦‚()
	this.weather = data.weather
	this.pictureUrl = data.pictureUrl
}
```



##### é€€å‡ºç™»é™†æ“ä½œ

###### è‡ªå®šä¹‰é“¾æ¥æŒ‰é’®ï¼ˆLink-Buttonï¼‰

```jsx
//ä½¿ç”¨å‡½æ•°ç»„ä»¶ï¼Œå› ä¸ºä¸éœ€è¦ä»€ä¹ˆé€»è¾‘ï¼Œè¿™ä¸ªç»„ä»¶ä¸»è¦æ˜¯å¯¹æ ·å¼çš„è¦æ±‚
import React from 'react'
import './index.less'

 //å®ç°çœ‹ä¼¼é“¾æ¥çš„é€šç”¨ç»„å»º
//propsä¼ é€’ç»„ä»¶çš„å±æ€§ç»™buttonæ ‡ç­¾ï¼Œå¦åˆ™äº‹ä»¶ç»‘å®šä¸äº†
//æ³¨æ„è¿™ä¸ªæ–¹æ³•åä¸€å®šè¦å®šä¹‰å¥½ï¼Œä¸ç„¶reactå¼€å‘è€…å·¥å…·æ‰¾ä¸åˆ°

export default function LinkButton(props) {
    return (
        <button className="link-buytton" {...props}>é€€å‡º</button>
    )
}


//ä½¿ç”¨æ—¶
 <LinkButton onClick={(e)=>{alert('tuichu')}}>é€€å‡º</LinkButton>

## reactç»„ä»¶ä¼šå°†æ ‡ç­¾ä½“å†…å®¹ä¼ é€’ç»™å†…éƒ¨æ ‡ç­¾ï¼Œå±æ€§åä¸ºchildren

//æ ‡ç­¾ä½“æ˜¯æ–‡æœ¬ï¼Œchildrenæ˜¯æ–‡æœ¬

//æ ‡ç­¾ä½“æ˜¯æ ‡ç­¾ï¼Œchildrenæ˜¯æ ‡ç­¾

//æ ‡ç­¾ä½“æ˜¯å¤šä¸ªæ ‡ç­¾ï¼Œchildrenæ˜¯æ•°ç»„
```



##### lessæ ·å¼ä¸­éœ€è¦æ³¨æ„çš„ç‚¹

```less
/*outlineæ˜¯è½®å»“ï¼Œcursoræ˜¯é¼ æ ‡æ˜¾ç¤º*/
.link-buytton {
    background-color: transparent;
    outline: none;
    border: none;
    cursor: pointer;
    color: yellowgreen;
}
```

æŒ‰é’®è§¦å‘å¯¹è¯æ¡†

##### modalçš„ä½¿ç”¨

```jsx
//å¦å¤–å½“éœ€è¦ä¸€ä¸ªç®€æ´çš„ç¡®è®¤æ¡†è¯¢é—®ç”¨æˆ·æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ Modal.confirm() ç­‰è¯­æ³•ç³–æ–¹æ³•ã€‚confirmæ˜¯è¯­æ³•ç³–ã€‚
//è°ƒç”¨showConfirmä¼šå°†å¯¹è¯æ¡†æ¢å‡º
//ç‚¹å‡»æ¨¡æ€æ¡†çš„æŒ‰é’®æ—¶ä¼šè°ƒç”¨onOKæˆ–è€…onCancel

import { Modal } from 'antd';

const { confirm } = Modal;

showConfirm =()=> {
    confirm({
        title: 'ä½ ç¡®è®¤è¦é€€å‡ºå—',
        content: 'é€€å‡ºéœ€è¦é‡æ–°ç™»é™†',
        onOk:()=> {

            //é€€å‡ºçš„é€»è¾‘
            //æ¸…é™¤localstorageã€‚æ¸…é™¤å†…å­˜
            storageUtils.removeUser()
            memoryUtils.user = {}
            message.success('é€€å‡ºç™»é™†')
            //è·³è½¬
            this.props.history.replace('/login')
        },
        onCancel() {
            console.log('å–æ¶ˆ');
        },
    });
}
```



##### å•†å“åˆ†ç±»

æŸ¥çœ‹ç•Œé¢è¦ä½¿ç”¨ä»€ä¹ˆç»„ä»¶

##### å¡ç‰‡ç»„ä»¶çš„ä½¿ç”¨

```jsx
//size:å°ºå¯¸  titleï¼šå¡ç‰‡çš„æ ‡é¢˜ extraï¼šå¡ç‰‡çš„é™„åŠ çš„éƒ¨åˆ†ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ ‡ç­¾

<Card size="small" title="Small size card" extra={<a href="#">More</a>} style={{ width: 300 }}>
      <p>Card content</p>
      <p>Card content</p>
      <p>Card content</p>
    </Card>

//å‘extraæ·»åŠ ä¸€ä¸ªé¢å¤–çš„æ ‡ç­¾
const extra = (
      <Button type="primary">
        <Icon type="plus"></Icon>
        æ·»åŠ 
      </Button>
    )
```

##### è¡¨æ ¼çš„ä½¿ç”¨

```javascript
//æ•°æ®æ•°ç»„
const dataSource = [
  {
    key: '1',
    name: 'èƒ¡å½¦æ–Œ',
    age: 32,
    address: 'è¥¿æ¹–åŒºæ¹–åº•å…¬å›­1å·',
  },
  {
    key: '2',
    name: 'èƒ¡å½¦ç¥–',
    age: 42,
    address: 'è¥¿æ¹–åŒºæ¹–åº•å…¬å›­1å·',
  },
];
//è¡¨å¤´æ•°ç»„
//cloumnsç”¨æ¥æ˜¾ç¤ºä¸€æ¡æ•°æ®
//æ•°æ®æ•°ç»„ä¸­çš„å±æ€§ä¸è¡¨å¤´æ•°ç»„çš„dataIndexå…·æœ‰æ˜ å°„å…³ç³»
const columns = [
  {
    title: 'å§“å',
    dataIndex: 'name',
    key: 'name',
  },
  {
    title: 'å¹´é¾„',
    dataIndex: 'age',
    key: 'age',
  },
  {
    title: 'ä½å€',
    dataIndex: 'address',
    key: 'address',
  },
];

<Table dataSource={dataSource} columns={columns} />;
//å¯¹äºè¦è¿›è¡Œé¢å¤–å¤„ç†çš„æ•°æ®,è¿›è¡Œrender()
render	
ç”Ÿæˆå¤æ‚æ•°æ®çš„æ¸²æŸ“å‡½æ•°ï¼Œå‚æ•°åˆ†åˆ«ä¸ºå½“å‰è¡Œçš„å€¼ï¼Œå½“å‰è¡Œæ•°æ®ï¼Œè¡Œç´¢å¼•ï¼Œ@return é‡Œé¢å¯ä»¥è®¾ç½®è¡¨æ ¼è¡Œ/åˆ—åˆå¹¶	Function(text, record, index) {}

//è¾¹æ¡†
bordered	æ˜¯å¦å±•ç¤ºå¤–è¾¹æ¡†å’Œåˆ—è¾¹æ¡†	boolean
//è¡Œçš„key
rowKey	è¡¨æ ¼è¡Œ key çš„å–å€¼ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–ä¸€ä¸ªå‡½æ•°	string|Function(record):string	
//åˆ†é¡µ
pagination={{ pageSize: 50 
           	onChange:this.xxxx(ä¸€ä¸ªå‡½æ•°)
           }}
           
 //å°†ä¸€ä¸ªæ ‡ç­¾ä½œä¸ºæ•°æ®
render:()=><a>delete</a>
//è·å–è¡¨å•è¡Œæ•°æ®
render:(category)=><Link onClick={(e)=>{
        this.handle(category,e)
    }}>delete</Link>
```



##### Table

| å‚æ•°       | è¯´æ˜                                                         | ç±»å‹                            | é»˜è®¤å€¼ | ç‰ˆæœ¬ |
| ---------- | ------------------------------------------------------------ | ------------------------------- | ------ | ---- |
| bordered   | æ˜¯å¦å±•ç¤ºå¤–è¾¹æ¡†å’Œåˆ—è¾¹æ¡†                                       | boolean                         | false  |      |
| rowKey     | è¡¨æ ¼è¡Œ key çš„å–å€¼ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–ä¸€ä¸ªå‡½æ•°                    | string\|Function(record):string | 'key'  |      |
| pagination | åˆ†é¡µå™¨ï¼Œå‚è€ƒ[é…ç½®é¡¹](https://ant.design/components/table-cn/#pagination)æˆ– [pagination](https://ant.design/components/pagination-cn/) æ–‡æ¡£ï¼Œè®¾ä¸º false æ—¶ä¸å±•ç¤ºå’Œè¿›è¡Œåˆ†é¡µ | object                          |        |      |
|            |                                                              |                                 |        |      |
|            |                                                              |                                 |        |      |



##### Pagination

| å‚æ•°            | è¯´æ˜                   | ç±»å‹                                 | é»˜è®¤å€¼ | ç‰ˆæœ¬ |
| :-------------- | :--------------------- | :----------------------------------- | :----- | :--- |
| current         | å½“å‰é¡µæ•°               | number                               | -      |      |
| defaultPageSize | é»˜è®¤çš„æ¯é¡µæ¡æ•°         | number                               | 10     |      |
| pageSize        | æ¯é¡µæ¡æ•°               | number                               | -      |      |
| total           | æ•°æ®æ€»æ•°               | number                               | 0      |      |
| showQuickJumper | æ˜¯å¦å¯ä»¥å¿«é€Ÿè·³è½¬è‡³æŸé¡µ | boolean \| `{ goButton: ReactNode }` | false  |      |
|                 |                        |                                      |        |      |



##### Column

| å‚æ•°   | è¯´æ˜                                                         | ç±»å‹                             | é»˜è®¤å€¼ | ç‰ˆæœ¬ |
| ------ | ------------------------------------------------------------ | -------------------------------- | ------ | ---- |
| render | ç”Ÿæˆå¤æ‚æ•°æ®çš„æ¸²æŸ“å‡½æ•°ï¼Œå‚æ•°åˆ†åˆ«ä¸ºå½“å‰è¡Œçš„å€¼ï¼Œå½“å‰è¡Œæ•°æ®ï¼Œè¡Œç´¢å¼•ï¼Œ@return é‡Œé¢å¯ä»¥è®¾ç½®è¡¨æ ¼[è¡Œ/åˆ—åˆå¹¶](https://ant.design/components/table-cn/#components-table-demo-colspan-rowspan) | Function(text, record, index) {} | -      |      |
| width  | åˆ—å®½åº¦ï¼ˆ[æŒ‡å®šäº†ä¹Ÿä¸ç”Ÿæ•ˆï¼Ÿ](https://github.com/ant-design/ant-design/issues/13825#issuecomment-449889241)ï¼‰ | string\|number                   |        |      |
|        |                                                              |                                  |        |      |
|        |                                                              |                                  |        |      |



##### ç¼–å†™è·¯ç”±è·å–åˆ†ç±»æ•°æ®

url:http://localhost:5000/manage/category/list

##### è·Ÿæ®APIæ–‡æ¡£ç¼–å†™è·å–æ•°æ®çš„æ¥å£



###### APIæ–‡æ¡£

![](http://47.103.65.182/markdown/004.png)

###### æ¥å£ç¼–å†™

```javascript
 export const reqCategorys = ()=>axios({
    url:'/manage/category/list',
    method:'GET',
  })
 //axiosè®¾ç½®äº†è¯·æ±‚æ‹¦æˆªå™¨ï¼Œå“åº”æ‹¦æˆªå™¨ï¼ŒåŸºç¡€urlï¼›åŸºç¡€urlä¸ºhttp://localhost:3000
 //è¯·æ±‚æ‹¦æˆªå™¨å°†postè¯·æ±‚å‚æ•°è½¬æ¢ä¸ºurlencoded(é»˜è®¤jsonæ ¼å¼)
 //å“åº”æ‹¦æˆªå™¨å°†å“åº”æ•°æ®çš„dataä½œä¸ºpromiseçš„è¿”å›å€¼
 
```

åœ¨componendDidMount()ä¸­å‘é€è¯·æ±‚ï¼Œå°†è·å–çš„åˆ†ç±»æ•°æ®å­˜åˆ°stateä¸­

```
Array(8)
0: {_id: "5d6fbbb84a4af5305884d49c", name: "pans", __v: 0}
1: {_id: "5d6fbbc24a4af5305884d49d", name: "dress", __v: 0}
2: {_id: "5d6fbbcb4a4af5305884d49e", name: "t-shirt", __v: 0}
3: {_id: "5d6fbbd14a4af5305884d49f", name: "shoes", __v: 0}
4: {_id: "5d6fbbd94a4af5305884d4a0", name: "cat", __v: 0}
5: {_id: "5d6fbbec4a4af5305884d4a1", name: "tree", __v: 0}
6: {_id: "5d6fbc0a4a4af5305884d4a2", name: "pangci", __v: 0}
7: {_id: "5d6fbc1b4a4af5305884d4a3", name: "clothes", __v: 0}
length: 8
__proto__: Array(0)
```

è®¾ç½®æ•°æ®æº

```javascript
const dataSource = this.state.categorys
```

##### åˆ—è¡¨æ˜¾ç¤ºè·å–çš„åˆ†ç±»æ•°æ®

è®¾ç½®è¡Œæ ·å¼

```javascript
const columns = [
  {
    title: 'å§“å',
    dataIndex: 'name',
    
  },
  {
    title: 'æ“ä½œ',
    width:250,
    align:'center',
    render:()=><LinkButton>ä¿®æ”¹åˆ†ç±»</LinkButton>
  },
];
```







##### loadingæ•ˆæœ

![](http://47.103.65.182/markdown/005.png)



loadingéœ€è¦ä¸€ä¸ªçŠ¶æ€æ¥ä¿å­˜



```javascript
getCategorys = async ()=>{
    
    this.setState({
      loading:true
    })
    const result = await reqCategorys()
    this.setState({
      loading:false
    })
    // console.log(result.data);
    if(result.status === 0){
        this.setState({
          categorys:result.data
        })
    }
  }
```



##### æä¸€ä¸ªæ¨¡æ€æ¡†æ˜¾ç¤ºä¸€ä¸‹

```jsx
 //å¼•å…¥
 import {Modal} from 'antd'
 render(){
 return(
     //ç»™ä»–å¡åˆ°cardé‡Œé¢//ç„¶åæŠŠå±æ€§å€¼è®¾ç½®ä¸€ä¸‹ï¼Œå›è°ƒç¼–å†™ä¸€ä¸‹
     <Card>
 <Modal
     title="Basic Modal"
     visible={this.state.visible}
     onOk={this.handleOk}
     onCancel={this.handleCancel}
     >
         <p>Some contents...</p>
         <p>Some contents...</p>
         <p>Some contents...</p>
     </Modal>
     </Card>
 )
 
 }
//ç”±äºè¦ç”¨ä¸€ä¸ªå˜é‡æ§åˆ¶ä¸¤ä¸ªå¯¹è¯æ¡†ï¼Œç®¡ç†ä¸‰ä¸ªçŠ¶æ€ï¼Œæ‰€æœ‰çš„çŠ¶æ€æœ‰3ä¸ªï¼š1.ä¸æ˜¾ç¤ºï¼Œ2.æ˜¾ç¤ºæ·»åŠ åˆ†ç±»ï¼Œ3.æ˜¾ç¤ºä¿®æ”¹åˆ†ç±»ã€‚æ‰€ä»¥é€‰æ‹©ç”¨æ•°å­—ä»£è¡¨çŠ¶æ€
/*åˆå§‹çŠ¶æ€ä¸ºä¸æ˜¾ç¤º
//categorysåˆ†ç±»åˆ—è¡¨
  //loadingï¼Œæ ‡è¯†æ˜¯å¦åœ¨è¯·æ±‚ä¸­
  //showStates,0ä¸æ˜¾ç¤ºï¼Œ1æ˜¾ç¤ºæ·»åŠ åˆ†ç±»ï¼Œ2æ˜¾ç¤ºä¿®æ”¹åˆ†ç±»
  state={
    categorys:[],
    loading:false,
    showStates:0
  }*/
//æ”¹å†™å¯¹è¯æ¡†
<Modal
          title="æ·»åŠ åˆ†ç±»"
          visible={showStates === 1}
          onOk={this.addCategory}
          onCancel={this.handleCancel}
          >
              <p>Some contents...</p>
              <p>Some contents...</p>
              <p>Some contents...</p>
          </Modal>
          <Modal
          title="ä¿®æ”¹åˆ†ç±»"
          visible={showStates === 2}
          onOk={this.updateCategory}
          onCancel={this.handleCancel}
          >
              <p>Some contents...</p>
              <p>Some contents...</p>
              <p>Some contents...</p>
          </Modal>
//å¯¹è¯æ¡†åŸºæœ¬çš„æ˜¾ç¤ºéšè—
  //æ˜¾ç¤ºæ·»åŠ å¯¹è¯æ¡†

  showAddCategory = ()=>{
    //æ›´æ”¹showStateçš„çŠ¶æ€ä¸º1
    this.setState({
      showStates:1
    })
  }

  //æ˜¾ç¤ºä¿®æ”¹å¯¹è¯æ¡†ï¼Œå¹¶å¡«å…¥æ•°æ®
  //å¦‚ä½•è·å–è¡Œçš„æ•°æ®å¹¶ä¼ ç»™å›æ‰å‡½æ•°å‘¢ï¼Œç”¨ä¸€ä¸ªç®­å¤´å‡½æ•°åŒ…ä¸€ä¸‹
  //render:(category)=>{ return <LinkButton onClick={()=>{this.showUpdateCategory(category)}}>ä¿®æ”¹åˆ†ç±»</LinkButton>}
  showUpdateCategory = ()=>{
    this.setState({
      showStates:2
    })
  }


  //ç‚¹å‡»å–æ¶ˆæŒ‰é’®
  handleCancel = ()=>{
    //å…³é—­æ·»åŠ å¯¹è¯æ¡†ï¼Œæ¸…ç©ºæ•°æ®
    this.setState({
      showStates:0
    })
  }
  
  //ä¸šåŠ¡é€»è¾‘
  
    //æ·»åŠ åˆ†ç±»
  addCategory = ()=>{
    //å‘é€è¯·æ±‚
  }

  //ä¿®æ”¹åˆ†ç±»
  updateCategory = ()=>{
    //å‘é€è¯·æ±‚
  }
  
 
```




| å‚æ•°     | è¯´æ˜                                 | ç±»å‹              | é»˜è®¤å€¼ | ç‰ˆæœ¬  |
| -------- | ------------------------------------ | ----------------- | ------ | ----- |
| title    | æ ‡é¢˜                                 | string\|ReactNode | æ—      |       |
| visible  | å¯¹è¯æ¡†æ˜¯å¦å¯è§                       | boolean           | æ—      |       |
| width    | å®½åº¦                                 | string\|number    | 520    |       |
| onOk     | ç‚¹å‡»ç¡®å®šå›è°ƒ                         | function(e)       | æ—      |       |
| onCancel | ç‚¹å‡»é®ç½©å±‚æˆ–å³ä¸Šè§’å‰æˆ–å–æ¶ˆæŒ‰é’®çš„å›è°ƒ | function(e)       | æ—      |       |
| keyboard | æ˜¯å¦æ”¯æŒé”®ç›˜ esc å…³é—­                | boolean           | true   | 3.4.2 |





ç”±äºä¸¤ä¸ªå¯¹è¯æ¡†æœ‰ç›¸ä¼¼çš„ä¸­é—´å†…å®¹ï¼Œæ‰€ä»¥å¯ä»¥å°†å…¶å®šä¹‰æˆä¸€ä¸ªç»„ä»¶

##### category-formç»„ä»¶



##### è¡¨å•éªŒè¯

Form

| å‚æ•°        | è¯´æ˜                                                         | ç±»å‹                        | é»˜è®¤å€¼ | ç‰ˆæœ¬ |
| ----------- | ------------------------------------------------------------ | --------------------------- | ------ | ---- |
| form        | ç» `Form.create()` åŒ…è£…è¿‡çš„ç»„ä»¶ä¼šè‡ªå¸¦ `this.props.form` å±æ€§ | object                      | -      |      |
| onSubmit    | æ•°æ®éªŒè¯æˆåŠŸåå›è°ƒäº‹ä»¶                                       | Function(e:Event)           |        |      |
| resetFields | é‡ç½®ä¸€ç»„è¾“å…¥æ§ä»¶çš„å€¼ï¼ˆä¸º `initialValue`ï¼‰ä¸çŠ¶æ€ï¼Œå¦‚ä¸ä¼ å…¥å‚æ•°ï¼Œåˆ™é‡ç½®æ‰€æœ‰ç»„ä»¶ | Function([names: string[]]) |        |      |
|             |                                                              |                             |        |      |
|             |                                                              |                             |        |      |
|             |                                                              |                             |        |      |

formå±æ€§

| æ–¹æ³•              | è¯´æ˜                                                         | ç±»å‹                                                         | ç‰ˆæœ¬ |
| ----------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ---- |
| getFieldDecorator | ç”¨äºå’Œè¡¨å•è¿›è¡ŒåŒå‘ç»‘å®šï¼Œè¯¦è§ä¸‹æ–¹æè¿°                         |                                                              |      |
| validateFields    | æ ¡éªŒå¹¶è·å–ä¸€ç»„è¾“å…¥åŸŸçš„å€¼ä¸ Errorï¼Œè‹¥ fieldNames å‚æ•°ä¸ºç©ºï¼Œåˆ™æ ¡éªŒå…¨éƒ¨ç»„ä»¶ | (   [fieldNames: string[]],   [options: object],   callback(errors, values) ) => void |      |
| getFieldValue     | è·å–ä¸€ä¸ªè¾“å…¥æ§ä»¶çš„å€¼                                         | Function(fieldName: string)                                  |      |
| getFieldsValue    | è·å–ä¸€ç»„è¾“å…¥æ§ä»¶çš„å€¼ï¼Œå¦‚ä¸ä¼ å…¥å‚æ•°ï¼Œåˆ™è·å–å…¨éƒ¨ç»„ä»¶çš„å€¼       | Function([fieldNames: string[]])                             |      |



```
const {
  form: { validateFields },
} = this.props;
validateFields((errors, values) => {
  // ...
});

```

- `errors`:

  ```js
  {
    "username": {
      "errors": [
        {
          "message": "Please input your username!",
          "field": "username"
        }
      ]
    },
    "password": {
      "errors": [
        {
          "message": "Please input your Password!",
          "field": "password"
        }
      ]
    }
  }
  ```

- `values`:

  ```js
  {
    "username": "username",
    "password": "password",
  }
  ```





##### getFieldDecorator(id, options) å‚æ•°

| å‚æ•°                 | è¯´æ˜                                                         | ç±»å‹     | é»˜è®¤å€¼ | ç‰ˆæœ¬ |
| -------------------- | ------------------------------------------------------------ | -------- | ------ | ---- |
| id                   | å¿…å¡«è¾“å…¥æ§ä»¶å”¯ä¸€æ ‡å¿—ã€‚æ”¯æŒåµŒå¥—å¼çš„[å†™æ³•](https://github.com/react-component/form/pull/48)ã€‚ | string   |        |      |
| options.rules        | æ ¡éªŒè§„åˆ™ï¼Œå‚è€ƒä¸‹æ–¹æ–‡æ¡£                                       | object[] |        |      |
| options.initialValue | å­èŠ‚ç‚¹çš„åˆå§‹å€¼ï¼Œç±»å‹ã€å¯é€‰å€¼å‡ç”±å­èŠ‚ç‚¹å†³å®š(æ³¨æ„ï¼šç”±äºå†…éƒ¨æ ¡éªŒæ—¶ä½¿ç”¨ `===` åˆ¤æ–­æ˜¯å¦å˜åŒ–ï¼Œå»ºè®®ä½¿ç”¨å˜é‡ç¼“å­˜æ‰€éœ€è®¾ç½®çš„å€¼è€Œéç›´æ¥ä½¿ç”¨å­—é¢é‡)) |          |        |      |
|                      |                                                              |          |        |      |



ä½¿ç”¨å®ä¾‹


```jsx
 const { getFieldDecorator } = this.props.form;
    return (
      <Form onSubmit={this.handleSubmit} className="login-form">
        <Form.Item>
          {getFieldDecorator('username', {
            rules: [{ required: true, message: 'Please input your username!' }],
          })(
            <Input
              prefix={<Icon type="user" style={{ color: 'rgba(0,0,0,.25)' }} />}
              placeholder="Username"
            />,
          )}
        </Form.Item>
```





æ ¡éªŒè§„åˆ™

| å‚æ•°       | è¯´æ˜                                                         | ç±»å‹                                    | é»˜è®¤å€¼   | ç‰ˆæœ¬ |
| ---------- | ------------------------------------------------------------ | --------------------------------------- | -------- | ---- |
| enum       | æšä¸¾ç±»å‹                                                     | string                                  | -        |      |
| len        | å­—æ®µé•¿åº¦                                                     | number                                  | -        |      |
| max        | æœ€å¤§é•¿åº¦                                                     | number                                  | -        |      |
| message    | æ ¡éªŒæ–‡æ¡ˆ                                                     | string\|ReactNode                       | -        |      |
| min        | æœ€å°é•¿åº¦                                                     | number                                  | -        |      |
| pattern    | æ­£åˆ™è¡¨è¾¾å¼æ ¡éªŒ                                               | RegExp                                  | -        |      |
| required   | æ˜¯å¦å¿…é€‰                                                     | boolean                                 | `false`  |      |
| transform  | æ ¡éªŒå‰è½¬æ¢å­—æ®µå€¼                                             | function(value) => transformedValue:any | -        |      |
| type       | å†…å»ºæ ¡éªŒç±»å‹ï¼Œ[å¯é€‰é¡¹](https://github.com/yiminghe/async-validator#type) | string                                  | 'string' |      |
| validator  | è‡ªå®šä¹‰æ ¡éªŒï¼ˆæ³¨æ„ï¼Œ[callback å¿…é¡»è¢«è°ƒç”¨](https://github.com/ant-design/ant-design/issues/5155)ï¼‰ | function(rule, value, callback)         | -        |      |
| whitespace | å¿…é€‰æ—¶ï¼Œç©ºæ ¼æ˜¯å¦ä¼šè¢«è§†ä¸ºé”™è¯¯                                 | boolean                                 | `false`  |      |





Form.create(options)

```

class CustomizedForm extends React.Component {}

CustomizedForm = Form.create({})(CustomizedForm);
```

| å‚æ•°           | è¯´æ˜                           | ç±»å‹                                      | ç‰ˆæœ¬ |
| -------------- | ------------------------------ | ----------------------------------------- | ---- |
| onValuesChange | ä»»ä¸€è¡¨å•åŸŸçš„å€¼å‘ç”Ÿæ”¹å˜æ—¶çš„å›è°ƒ | (props, changedValues, allValues) => void |      |
|                |                                |                                           |      |



##### è¢«Form.createåŒ…è£…åçš„è¡¨å•ç»„ä»¶ï¼Œå¦‚ä½•å®ç°è¡¨å•éªŒè¯

```jsx
 render() {

        //1.è·å–å­—æ®µè£…é¥°å™¨
     //getFieldDecorator(id,options)(æ ‡ç­¾)
     //id:è¡¨å•åŸŸçš„å”¯ä¸€æ ‡è¯†ç¬¦
     //options:é…ç½®å¯¹è±¡
     //æ ‡ç­¾ï¼šå°†è¦åŒ…è£…çš„è¡¨å•æ§ä»¶æ ‡ç­¾
        const { getFieldDecorator } = this.props.form;
        const {categoryName} = this.props;

        //console.log(categoryName)

        return (
            <Form>
                <Item>
                    {/* 2.è£…é¥°å­—æ®µ */}
                    {
                        getFieldDecorator('categoryName',{
                            initialValue:categoryName,
                            rules:[
                                {whitespace:true,message:"åˆ†ç±»åä¸èƒ½ä¸ºç©º"},
                                {required:true,message:"å¿…é¡»è¾“å…¥åˆ†ç±»åç§°"}
                            ]
                        })(<Input placeholder="è¯·è¾“å…¥åˆ†ç±»åç§°"></Input>)
                    }
                    
                </Item>
            </Form>
        )
    }
```



##### å®ç°æ·»åŠ ç±»åˆ«åŠŸèƒ½

##### å¦‚ä½•å–å¾—formç»„ä»¶çš„æ•°æ®

æ–¹æ¡ˆä¸€ï¼Œçˆ¶å­é€šä¿¡ï¼Œformç»„ä»¶å°†è‡ªå·±çš„formå¯¹è±¡ä¼ é€’ç»™çˆ¶ç»„ä»¶

å®ç°ï¼šçˆ¶ç»„ä»¶å®šä¹‰ä¸€ä¸ªæ–¹æ³•åå«setForm(form)ï¼Œé€šè¿‡å†™åœ¨ç»„ä»¶æ ‡ç­¾é‡Œä¼ é€’ç»™å­ç»„ä»¶ï¼Œå­ç»„ä»¶é€šè¿‡ç»„ä»¶çš„propså±æ€§å¾—åˆ°è¯¥æ–¹æ³•ï¼Œåœ¨componendWillMounté’©å­å‡½æ•°ä¸­è°ƒç”¨,å¼ è€å¸ˆè¯´formå¯¹è±¡æ—¶ä¸ä¼šå˜åŒ–çš„

```jsx
//çˆ¶ç»„ä»¶
//å°†formä¿å­˜åˆ°ç»„ä»¶å¯¹è±¡
  setForm = (form)=>{
    message.success('OK')
    this.form = form
  }
  //å­ç»„ä»¶
   <CategoryForm setForm={this.setForm} categoryName={category.name}></CategoryForm>
   //===================================================================================
   componentWillMount(){
        this.props.setForm(this.props.form);
    }
```



å®šä¹‰å‘é€è¯·æ±‚çš„æ¥å£

```javascript
  //æ·»åŠ åˆ†ç±»
  export const reqAddCategory = (categoryName)=>axios({
    url:'/manage/category/add',
    method:'POST',
    data:{categoryName}
  })

  //ä¿®æ”¹åˆ†ç±»
  export const reqUpdateCategory = (categoryId,categoryName)=>axios({
    url:'/manage/category/update',
    method:'POST',
    data:{categoryId,categoryName}
  })
```



å®Œæˆæ•°æ®æ·»åŠ ä»¥åŠ**#æ“¦æ¡Œå­çš„å·¥ä½œ**

```jsx
#æ“¦æ¡Œå­  
//1.æˆæ”»äº†é¦–å…ˆå…³é—­å¯¹è¯æ¡†
//2.æ›´æ–°æ•°æ®æ˜¾ç¤º
//3.å°†è¡¨å•çš„æ•°æ®æ¸…ç©ºï¼›åœ¨ä¸¤ç§å¯¹ç±»åˆ«çš„æ“ä½œä¸­ï¼Œéƒ½å­˜åœ¨è¡¨å•æ•°æ®çš„ç•™å­˜é—®é¢˜ï¼›
 /* æ˜¯è¿™ä¸ªå­—æ®µçš„é—®é¢˜
 	initialValue:categoryName,
 å¦‚æœä¸æ‰‹åŠ¨è¾“å…¥ä¿®æ”¹ï¼Œæ¯æ¬¡æŒ‡å®šçš„æ–°çš„éƒ½æœ‰æ•ˆ ï¼›
    å¦‚æœæ‰‹åŠ¨è¾“å…¥äº†ï¼Œå†æŒ‡å®šæ–°çš„æ— æ•ˆï¼ˆæ€»æ˜¯æ˜¾ç¤ºæ‰‹åŠ¨è¾“å…¥ï¼‰
   */
//è§£å†³æ–¹æ³•ï¼Œä½¿ç”¨formçš„resetFieldsæ–¹æ³•ï¼Œ
//è§£å†³æ—¶æœºï¼šåœ¨æ·»åŠ æˆåŠŸæˆ–ä¿®æ”¹æˆåŠŸï¼Œä»¥åŠå…³é—­å¯¹è¯æ¡†çš„æ—¶å€™è°ƒç”¨


//æ·»åŠ åˆ†ç±»
  addCategory = ()=>{
    //å‘é€è¯·æ±‚
    //è¿›è¡ŒéªŒè¯
   // è·å–form
   this.form.validateFields( async (err,values)=>{
      //éªŒè¯æˆåŠŸï¼Œå‘é€è¯·æ±‚
      if(!err){
        //å‘é€è¯·æ±‚
        //è·å–categoryName
        const {categoryName} = values;
        const result = await reqAddCategory(categoryName)
        if (result.status === 0){
          //å…³é—­å¯¹è¯æ¡†
          this.setState({
            showStates:0
          })
          //è·å–æœ€æ–°çš„æ•°æ®æ˜¾ç¤º
          this.getCategorys()
        }else{
          
          message.error('error')
        }
      }else{
        message.error('éªŒè¯å¤±è´¥')
      }
   })
  }
```



åŒç†å®Œæˆæ•°æ®ä¿®æ”¹ï¼Œä¹Ÿæ˜¯å–å¾—æ•°æ®å‘é€è¯·æ±‚ï¼Œä»¥åŠæ“¦æ¡Œå­

```jsx
  //ä¿®æ”¹åˆ†ç±»
  updateCategory = ()=>{
     //å‘é€è¯·æ±‚
    //è¿›è¡ŒéªŒè¯
   // è·å–form
   this.form.validateFields( async (err,values)=>{
    //éªŒè¯æˆåŠŸï¼Œå‘é€è¯·æ±‚
    if(!err){
      //å‘é€è¯·æ±‚
      //è·å–categoryName
      this.form.resetFields()
      const {categoryName} = values
      const categoryId = this.category._id
      console.log(categoryName,categoryId)

      const result = await reqUpdateCategory(categoryId,categoryName)
      if (result.status === 0){
        //å…³é—­å¯¹è¯æ¡†
        this.setState({
          showStates:0
        })
        //è·å–æœ€æ–°çš„æ•°æ®æ˜¾ç¤º
        this.getCategorys()
        message.success('ä¿®æ”¹æˆåŠŸ')
      }else{
        
        message.error('ä¿®æ”¹å¤±è´¥')
      }
    }else{
      message.error('éªŒè¯å¤±è´¥')
    }
 })

  }
```

