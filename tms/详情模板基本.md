## 详情配置有关页面

1.平台层——>租户管理员——>详情模板维护

2.租户层——>租户管理员——>详情页面配置

代码位置

![image-20230216125144002](https://typora-huang-cong.oss-cn-shanghai.aliyuncs.com/image-20230216125144002.png)

3.页面渲染 /dynamic-detail-template/:configXid/:tempXid/:type/:id

代码位置

![image-20230216125039608](https://typora-huang-cong.oss-cn-shanghai.aliyuncs.com/image-20230216125039608.png)



## 模板注册

平台层——>租户管理员——>详情模板维护

![image-20230216114119736](https://typora-huang-cong.oss-cn-shanghai.aliyuncs.com/image-20230216114119736.png)



## 模板编写







1.编写模板

![image-20230216114557321](https://typora-huang-cong.oss-cn-shanghai.aliyuncs.com/image-20230216114557321.png)



2.导出模板

![image-20230216114325418](https://typora-huang-cong.oss-cn-shanghai.aliyuncs.com/image-20230216114325418.png)



## 模板编写流程（最简流程）

1.复制OrderRelease1

![image-20230216141111883](https://typora-huang-cong.oss-cn-shanghai.aliyuncs.com/image-20230216141111883.png)

2.修改模板元信息（meta.ts）

![image-20230216141206879](https://typora-huang-cong.oss-cn-shanghai.aliyuncs.com/image-20230216141206879.png)

3.objectInfo 【页面基本配置，包括主对象，tab页对象，页面预设按钮】

3.1card修改

* 将objectType修改为主对象类型（取决于具体页面）

如订单可在对象维护看到是orderMovement

![image-20230216141533358](https://typora-huang-cong.oss-cn-shanghai.aliyuncs.com/image-20230216141533358.png)

![image-20230216141622666](https://typora-huang-cong.oss-cn-shanghai.aliyuncs.com/image-20230216141622666.png)

* 将dataSetPropsSource属性修改为主对象的数据源

从要配置的页面里找到url替换

![image-20230216142427880](https://typora-huang-cong.oss-cn-shanghai.aliyuncs.com/image-20230216142427880.png)

一个标准dataSetPropsSource的样子

```typescript
// 查询明细头
const queryDetailHeadUrl = `${HCES_HTMS}/v1/${currentTenantID}/htms/order/getPlanOrderById`;

const detailHeadDs: DataSetPropsSource = (basicParams?: BasicParams): DataSetProps => {
  

  return {
    autoCreate: true,
    // 测试头行结构
    transport: {
      read: () => {
        return {
          url: queryDetailHeadUrl,
          method: 'GET',
          params: {
            id: basicParams?.id,
          },
        };
      },
    },
    events: {
      query: () => basicParams?.id,
    },
  };
};
```



3.2tab修改

* 修改对象类型，同card
* 修改dataSetPropsSource，同card

3.3预设按钮修改

预设按钮在页面的位置

![image-20230216143216885](https://typora-huang-cong.oss-cn-shanghai.aliyuncs.com/image-20230216143216885.png)

name:按钮名称

objectType按钮的对象类型，改成主对象类型

macroCode:按钮调用的宏

![image-20230216143020306](https://typora-huang-cong.oss-cn-shanghai.aliyuncs.com/image-20230216143020306.png)



4.page修改

card配置的字段不用管

1.tab页声明

![image-20230216143614647](https://typora-huang-cong.oss-cn-shanghai.aliyuncs.com/image-20230216143614647.png)



按照模板源信息的tid声明对应的tab页

![image-20230216143719611](https://typora-huang-cong.oss-cn-shanghai.aliyuncs.com/image-20230216143719611.png)

![image-20230216143750527](https://typora-huang-cong.oss-cn-shanghai.aliyuncs.com/image-20230216143750527.png)

2.tab页编写根据需求而定

2.1若为带有预设按钮tab页，需在tab中声明按钮，并自定义处理函数

![image-20230216144111248](https://typora-huang-cong.oss-cn-shanghai.aliyuncs.com/image-20230216144111248.png)

![image-20230216144329840](https://typora-huang-cong.oss-cn-shanghai.aliyuncs.com/image-20230216144329840.png)

2.1若为普通tab页

![image-20230216144402499](https://typora-huang-cong.oss-cn-shanghai.aliyuncs.com/image-20230216144402499.png)

则使用prop中的数据正常渲染即可

![image-20230216144543506](https://typora-huang-cong.oss-cn-shanghai.aliyuncs.com/image-20230216144543506.png)

3.预设按钮声明，编写自定义的执行方法

![image-20230216143905190](https://typora-huang-cong.oss-cn-shanghai.aliyuncs.com/image-20230216143905190.png)

4.杂项

![image-20230216144820336](https://typora-huang-cong.oss-cn-shanghai.aliyuncs.com/image-20230216144820336.png)
